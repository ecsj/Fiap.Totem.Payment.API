using Application.Interfaces;
using Domain.Base;
using Domain.Entities;
using Domain.Request;
using Domain.Response;

namespace Application.UseCases;

public class PaymentService : IPaymentService
{
    private readonly IMessageQueueService _messageQueueService;

    private const string QrCode = "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";

    public PaymentService(IMessageQueueService messageQueueService)
    {
        _messageQueueService = messageQueueService;
    }

    public async Task<PaymentResponse> RequestPayment(PaymentRequest request)
    {
        return new PaymentResponse()
        {
            OrderId = request.OrderId,
            Id = request.PaymentId,
            QrCode = QrCode,
            Status = PaymentStatus.Pending
        };    
    }

    public PaymentResponse GetPayment(Guid id)
    {
        return new PaymentResponse()
        {
            Id = id,
            Status = PaymentStatus.Approved
        };
    }

    public bool ProcessPayment(PaymentWebook request)
    {
        var simulatedPaymnet = new PaymentResponse()
        {
            OrderId = request.OrderId,
            Id = request.PaymentId,
            Status = request.Status
        };

        _messageQueueService.PublishMessage("Totem.Payment.ProcessedPayment", simulatedPaymnet.ToJson());

        return true;
    }
}